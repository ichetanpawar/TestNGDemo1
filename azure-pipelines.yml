trigger:
- master

pool:
  #name: linux-agents
  vmImage: 'ubuntu-latest'

steps:
- script: |
    sudo apt-get install -y unzip openjdk-8-jre-headless xvfb libxi6 libgconf-2-4
        
    wget https://dl.google.com/linux/direct/google-chrome-stable_current_amd64.deb
    sudo dpkg -i google-chrome-stable_current_amd64.deb
    cd /usr/bin/
    wget https://chromedriver.storage.googleapis.com/2.35/chromedriver_linux64.zip
    unzip chromedriver_linux64.zip
    sudo chmod +x /usr/bin/chromedriver 
    sudo apt-get install xvfb
    cd /usr/bin/
    wget https://selenium-release.storage.googleapis.com/3.13/selenium-server-standalone-3.13.0.jar
    sudo chmod +x selenium-server-standalone-3.13.0.jar
    xvfb-run java -cp "./lib/*:./bin" -jar /usr/bin/selenium-server-standalone.jar org.testng.TestNG testng.xml

- task: PublishPipelineArtifact@1
  inputs:
      targetPath: '$(Build.SourcesDirectory)/results'
      artifact: 'Results'
      publishLocation: 'pipeline'
  condition: succeededOrFailed()


